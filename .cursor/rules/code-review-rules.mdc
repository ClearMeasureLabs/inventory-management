---
description: Automated PR code review process
globs: []
alwaysApply: false
---

# Code Review Rules

## Before Reviewing

1. **Fetch the issue**: Extract from PR body ("Closes #" or "Fixes #"). Read requirements, acceptance criteria, technical design.
2. **Check README**: Does it need updates for new features, scripts, or config?
3. **Update labels**: Remove any existing labels, then add `In Review By Agent`.

```bash
gh pr edit [PR] --remove-label "Approved by Agent" --remove-label "Development" --add-label "In Review By Agent"
```

## Review Checklist

Evaluate against project rules:

- **Architecture** (`architecture-rules.mdc`): Layer boundaries, CQRS patterns, DTOs not entities, no unauthorized package/SDK changes
- **Testing** (`automated-testing-rules.mdc`): Required tests exist, AAA pattern followed
- **Documentation**: README updated, complex logic commented
- **Code Quality**: No linter errors, consistent naming, proper error handling, no hardcoded config
- **Issue Requirements**: Acceptance criteria met, edge cases handled

## Posting the Review

```markdown
## Automated Code Review

### Checklist Results
#### Architecture Rules
- [x] Layer boundaries respected
- [ ] Issue: [describe problem]

#### Testing
- [x] Required tests added

#### Documentation
- [x] README updated

#### Code Quality
- [x] No linter errors

#### Issue Requirements
- [x] Acceptance criteria met

### Summary
[Brief findings]

### Required Changes
[Specific changes or "None - approved"]
```

## Decision

### Recommend Approval
If all checklist items pass:
1. Remove existing labels, add `Approved by Agent`
2. **Do NOT** use `gh pr review --approve`â€”only add the label

```bash
gh pr edit [PR] --remove-label "In Review By Agent" --remove-label "Development" --add-label "Approved by Agent"
```

### Request Changes
If issues are found:
1. Remove existing labels, add `Development`
2. Convert PR back to draft

```bash
gh pr edit [PR] --remove-label "In Review By Agent" --remove-label "Approved by Agent" --add-label "Development"
gh pr ready [PR] --undo
```
